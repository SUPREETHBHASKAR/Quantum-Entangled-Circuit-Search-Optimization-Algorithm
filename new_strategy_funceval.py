import numpy as np
import random
import matplotlib.pyplot as plt
from itertools import product
import csv
import os

# Problem-specific parameters
# profits = np.array([
#     90000, 89750, 10001, 89500, 10252, 89250, 10503, 89000, 10754, 88750,
#     11005, 88500, 11256, 88250, 11507, 88000, 11758, 87750, 12009, 87500,
#     12260, 87250, 12511, 87000, 12762, 86750, 13013, 86500, 13264, 86250
# ])
#
# weights = np.array([
#     90001, 89751, 10002, 89501, 10254, 89251, 10506, 89001, 10758, 88751,
#     11010, 88501, 11262, 88251, 11514, 88001, 11766, 87751, 12018, 87501,
#     12270, 87251, 12522, 87001, 12774, 86751, 13026, 86501, 13278, 86251
# ])
#
# capacity = 100000

#100design variable
# profits = np.array([
#     94, 506, 416, 992, 649, 237, 457, 815, 446, 422, 791, 359, 667, 598, 7, 544, 334, 766, 994, 893, 633, 131, 428, 700, 617, 874, 720, 419, 794, 196, 997, 116, 908, 539, 707, 569, 537, 931, 726, 487, 772, 513, 81, 943, 58, 303, 764, 536, 724, 789, 479, 142, 339, 641, 196, 494, 66, 824, 208, 711, 800, 314, 289, 401, 466, 689, 833, 225, 244, 849, 113, 379, 361, 65, 486, 686, 286, 889, 24, 491, 891, 90, 181, 214, 17, 472, 418, 419, 356, 682, 306, 201, 385, 952, 500, 194, 737, 324, 992, 224
# ])
#
# weights = np.array([
#     485, 326, 248, 421, 322, 795, 43, 845, 955, 252, 9, 901, 122, 94, 738, 574, 715, 882, 367, 984, 299, 433, 682, 72, 874, 138, 856, 145, 995, 529, 199, 277, 97, 719, 242, 107, 122, 70, 98, 600, 645, 267, 972, 895, 213, 748, 487, 923, 29, 674, 540, 554, 467, 46, 710, 553, 191, 724, 730, 988, 90, 340, 549, 196, 865, 678, 570, 936, 722, 651, 123, 431, 508, 585, 853, 642, 992, 725, 286, 812, 859, 663, 88, 179, 187, 619, 261, 846, 192, 261, 514, 886, 530, 849, 294, 799, 391, 330, 298, 790
# ])
# capacity = 995

#1000design variable

# profits = np.array([
#     585, 194, 426, 606, 348, 516, 521, 1092, 422, 749, 895, 337, 143, 557, 945, 915, 1055, 546, 352, 522, 109, 891, 1001, 459, 222, 767, 194, 698, 838, 107, 674, 644, 815, 434, 982, 866, 467, 1094, 1084, 993, 399, 733, 533, 231, 782, 528, 172, 800, 974, 717, 238, 974, 956, 820, 245, 519, 1095, 894, 629, 296, 299, 1097, 377, 216, 197, 1008, 819, 639, 342, 807, 207, 669, 222, 637, 170, 1031, 198, 826, 700, 587, 745, 872, 367, 613, 1072, 181, 995, 1043, 313, 158, 848, 403, 587, 864, 1023, 636, 129, 824, 774, 889, 640, 579, 654, 242, 567, 439, 146, 741, 810, 296, 653, 594, 291, 166, 824, 924, 830, 308, 1088, 811, 190, 900, 440, 414, 649, 389, 296, 501, 965, 566, 778, 789, 670, 933, 1036, 325, 822, 344, 751, 949, 223, 213, 531, 479, 608, 461, 685, 165, 953, 586, 742, 786, 1092, 386, 825, 989, 386, 124, 912, 591, 959, 991, 763, 190, 188, 281, 279, 314, 287, 117, 719, 572, 361, 518, 946, 519, 292, 456, 361, 782, 614, 406, 986, 301, 630, 485, 949, 1052, 394, 600, 899, 294, 491, 837, 430, 424, 398, 1092, 890, 324, 375, 360, 926, 197, 172, 310, 966, 749, 1051, 1019, 848, 163, 785, 1058, 1056, 904, 664, 618, 283, 528, 500, 637, 821, 446, 307, 253, 423, 1071, 711, 762, 216, 297, 209, 191, 895, 629, 443, 226, 962, 847, 785, 569, 110, 870, 981, 1034, 1084, 823, 503, 995, 460, 668, 549, 272, 641, 1058, 372, 483, 977, 408, 459, 1070, 807, 683, 408, 148, 870, 1030, 130, 669, 308, 103, 411, 120, 200, 709, 1039, 987, 522, 925, 885, 1030, 470, 1004, 1089, 341, 1069, 479, 243, 476, 1072, 1062, 128, 989, 161, 543, 738, 316, 448, 438, 447, 260, 166, 506, 491, 259, 738, 131, 395, 304, 926, 520, 296, 253, 549, 525, 955, 431, 243, 665, 587, 938, 240, 109, 664, 1018, 715, 633, 235, 332, 664, 1057, 460, 691, 893, 676, 263, 846, 959, 477, 860, 958, 811, 186, 762, 534, 259, 658, 760, 379, 368, 940, 1048, 835, 415, 674, 776, 226, 441, 1012, 789, 839, 994, 921, 806, 725, 590, 1017, 578, 301, 771, 1093, 1032, 249, 999, 152, 337, 859, 287, 367, 572, 356, 872, 883, 198, 217, 1006, 616, 1011, 280, 735, 125, 325, 480, 923, 812, 264, 366, 443, 316, 832, 548, 602, 641, 840, 764, 676, 1054, 712, 826, 1002, 872, 554, 631, 511, 1043, 1073, 850, 803, 427, 950, 1017, 177, 105, 320, 213, 902, 1013, 503, 891, 281, 1098, 110, 959, 625, 445, 1019, 531, 768, 775, 627, 933, 562, 538, 391, 623, 705, 1016, 557, 520, 505, 215, 517, 760, 379, 361, 785, 872, 696, 488, 407, 864, 324, 943, 422, 306, 940, 507, 1075, 739, 501, 952, 191, 642, 427, 160, 430, 857, 282, 182, 703, 737, 893, 193, 715, 714, 833, 236, 964, 287, 116, 202, 963, 1072, 1087, 263, 406, 601, 134, 577, 585, 194, 426, 606, 348, 516, 521, 1092, 422, 749, 895, 337, 143, 557, 945, 915, 1055, 546, 352, 522, 109, 891, 1001, 459, 222, 767, 194, 698, 838, 107, 674, 644, 815, 434, 982, 866, 467, 1094, 1084, 993, 399, 733, 533, 231, 782, 528, 172, 800, 974, 717, 238, 974, 956, 820, 245, 519, 1095, 894, 629, 296, 299, 1097, 377, 216, 197, 1008, 819, 639, 342, 807, 207, 669, 222, 637, 170, 1031, 198, 826, 700, 587, 745, 872, 367, 613, 1072, 181, 995, 1043, 313, 158, 848, 403, 587, 864, 1023, 636, 129, 824, 774, 889, 640, 579, 654, 242, 567, 439, 146, 741, 810, 296, 653, 594, 291, 166, 824, 924, 830, 308, 1088, 811, 190, 900, 440, 414, 649, 389, 296, 501, 965, 566, 778, 789, 670, 933, 1036, 325, 822, 344, 751, 949, 223, 213, 531, 479, 608, 461, 685, 165, 953, 586, 742, 786, 1092, 386, 825, 989, 386, 124, 912, 591, 959, 991, 763, 190, 188, 281, 279, 314, 287, 117, 719, 572, 361, 518, 946, 519, 292, 456, 361, 782, 614, 406, 986, 301, 630, 485, 949, 1052, 394, 600, 899, 294, 491, 837, 430, 424, 398, 1092, 890, 324, 375, 360, 926, 197, 172, 310, 966, 749, 1051, 1019, 848, 163, 785, 1058, 1056, 904, 664, 618, 283, 528, 500, 637, 821, 446, 307, 253, 423, 1071, 711, 762, 216, 297, 209, 191, 895, 629, 443, 226, 962, 847, 785, 569, 110, 870, 981, 1034, 1084, 823, 503, 995, 460, 668, 549, 272, 641, 1058, 372, 483, 977, 408, 459, 1070, 807, 683, 408, 148, 870, 1030, 130, 669, 308, 103, 411, 120, 200, 709, 1039, 987, 522, 925, 885, 1030, 470, 1004, 1089, 341, 1069, 479, 243, 476, 1072, 1062, 128, 989, 161, 543, 738, 316, 448, 438, 447, 260, 166, 506, 491, 259, 738, 131, 395, 304, 926, 520, 296, 253, 549, 525, 955, 431, 243, 665, 587, 938, 240, 109, 664, 1018, 715, 633, 235, 332, 664, 1057, 460, 691, 893, 676, 263, 846, 959, 477, 860, 958, 811, 186, 762, 534, 259, 658, 760, 379, 368, 940, 1048, 835, 415, 674, 776, 226, 441, 1012, 789, 839, 994, 921, 806, 725, 590, 1017, 578, 301, 771, 1093, 1032, 249, 999, 152, 337, 859, 287, 367, 572, 356, 872, 883, 198, 217, 1006, 616, 1011, 280, 735, 125, 325, 480, 923, 812, 264, 366, 443, 316, 832, 548, 602, 641, 840, 764, 676, 1054, 712, 826, 1002, 872, 554, 631, 511, 1043, 1073, 850, 803, 427, 950, 1017, 177, 105, 320, 213, 902, 1013, 503, 891, 281, 1098, 110, 959, 625, 445, 1019, 531, 768, 775, 627, 933, 562, 538, 391, 623, 705, 1016, 557, 520, 505, 215, 517, 760, 379, 361, 785, 872, 696, 488, 407, 864, 324, 943, 422, 306, 940, 507, 1075, 739, 501, 952, 191, 642, 427, 160, 430, 857, 282, 182, 703, 737, 893, 193, 715, 714, 833, 236, 964, 287, 116, 202, 963, 1072, 1087, 263, 406, 601, 134, 577
# ])
#
# weights = np.array([
#     485, 94, 326, 506, 248, 416, 421, 992, 322, 649, 795, 237, 43, 457, 845, 815, 955, 446, 252, 422, 9, 791, 901, 359, 122, 667, 94, 598, 738, 7, 574, 544, 715, 334, 882, 766, 367, 994, 984, 893, 299, 633, 433, 131, 682, 428, 72, 700, 874, 617, 138, 874, 856, 720, 145, 419, 995, 794, 529, 196, 199, 997, 277, 116, 97, 908, 719, 539, 242, 707, 107, 569, 122, 537, 70, 931, 98, 726, 600, 487, 645, 772, 267, 513, 972, 81, 895, 943, 213, 58, 748, 303, 487, 764, 923, 536, 29, 724, 674, 789, 540, 479, 554, 142, 467, 339, 46, 641, 710, 196, 553, 494, 191, 66, 724, 824, 730, 208, 988, 711, 90, 800, 340, 314, 549, 289, 196, 401, 865, 466, 678, 689, 570, 833, 936, 225, 722, 244, 651, 849, 123, 113, 431, 379, 508, 361, 585, 65, 853, 486, 642, 686, 992, 286, 725, 889, 286, 24, 812, 491, 859, 891, 663, 90, 88, 181, 179, 214, 187, 17, 619, 472, 261, 418, 846, 419, 192, 356, 261, 682, 514, 306, 886, 201, 530, 385, 849, 952, 294, 500, 799, 194, 391, 737, 330, 324, 298, 992, 790, 224, 275, 260, 826, 97, 72, 210, 866, 649, 951, 919, 748, 63, 685, 958, 956, 804, 564, 518, 183, 428, 400, 537, 721, 346, 207, 153, 323, 971, 611, 662, 116, 197, 109, 91, 795, 529, 343, 126, 862, 747, 685, 469, 10, 770, 881, 934, 984, 723, 403, 895, 360, 568, 449, 172, 541, 958, 272, 383, 877, 308, 359, 970, 707, 583, 308, 48, 770, 930, 30, 569, 208, 3, 311, 20, 100, 609, 939, 887, 422, 825, 785, 930, 370, 904, 989, 241, 969, 379, 143, 376, 972, 962, 28, 889, 61, 443, 638, 216, 348, 338, 347, 160, 66, 406, 391, 159, 638, 31, 295, 204, 826, 420, 196, 153, 449, 425, 855, 331, 143, 565, 487, 838, 140, 9, 564, 918, 615, 533, 135, 232, 564, 957, 360, 591, 793, 576, 163, 746, 859, 377, 760, 858, 711, 86, 662, 434, 159, 558, 660, 279, 268, 840, 948, 735, 315, 574, 676, 126, 341, 912, 689, 739, 894, 821, 706, 625, 490, 917, 478, 201, 671, 993, 932, 149, 899, 52, 237, 759, 187, 267, 472, 256, 772, 783, 98, 117, 906, 516, 911, 180, 635, 25, 225, 380, 823, 712, 164, 266, 343, 216, 732, 448, 502, 541, 740, 664, 576, 954, 612, 726, 902, 772, 454, 531, 411, 943, 973, 750, 703, 327, 850, 917, 77, 5, 220, 113, 802, 913, 403, 791, 181, 998, 10, 859, 525, 345, 919, 431, 668, 675, 527, 833, 462, 438, 291, 523, 605, 916, 457, 420, 405, 115, 417, 660, 279, 261, 685, 772, 596, 388, 307, 764, 224, 843, 322, 206, 840, 407, 975, 639, 401, 852, 91, 542, 327, 60, 330, 757, 182, 82, 603, 637, 793, 93, 615, 614, 733, 136, 864, 187, 16, 102, 863, 972, 987, 163, 306, 501, 34, 477, 485, 94, 326, 506, 248, 416, 421, 992, 322, 649, 795, 237, 43, 457, 845, 815, 955, 446, 252, 422, 9, 791, 901, 359, 122, 667, 94, 598, 738, 7, 574, 544, 715, 334, 882, 766, 367, 994, 984, 893, 299, 633, 433, 131, 682, 428, 72, 700, 874, 617, 138, 874, 856, 720, 145, 419, 995, 794, 529, 196, 199, 997, 277, 116, 97, 908, 719, 539, 242, 707, 107, 569, 122, 537, 70, 931, 98, 726, 600, 487, 645, 772, 267, 513, 972, 81, 895, 943, 213, 58, 748, 303, 487, 764, 923, 536, 29, 724, 674, 789, 540, 479, 554, 142, 467, 339, 46, 641, 710, 196, 553, 494, 191, 66, 724, 824, 730, 208, 988, 711, 90, 800, 340, 314, 549, 289, 196, 401, 865, 466, 678, 689, 570, 833, 936, 225, 722, 244, 651, 849, 123, 113, 431, 379, 508, 361, 585, 65, 853, 486, 642, 686, 992, 286, 725, 889, 286, 24, 812, 491, 859, 891, 663, 90, 88, 181, 179, 214, 187, 17, 619, 472, 261, 418, 846, 419, 192, 356, 261, 682, 514, 306, 886, 201, 530, 385, 849, 952, 294, 500, 799, 194, 391, 737, 330, 324, 298, 992, 790, 224, 275, 260, 826, 97, 72, 210, 866, 649, 951, 919, 748, 63, 685, 958, 956, 804, 564, 518, 183, 428, 400, 537, 721, 346, 207, 153, 323, 971, 611, 662, 116, 197, 109, 91, 795, 529, 343, 126, 862, 747, 685, 469, 10, 770, 881, 934, 984, 723, 403, 895, 360, 568, 449, 172, 541, 958, 272, 383, 877, 308, 359, 970, 707, 583, 308, 48, 770, 930, 30, 569, 208, 3, 311, 20, 100, 609, 939, 887, 422, 825, 785, 930, 370, 904, 989, 241, 969, 379, 143, 376, 972, 962, 28, 889, 61, 443, 638, 216, 348, 338, 347, 160, 66, 406, 391, 159, 638, 31, 295, 204, 826, 420, 196, 153, 449, 425, 855, 331, 143, 565, 487, 838, 140, 9, 564, 918, 615, 533, 135, 232, 564, 957, 360, 591, 793, 576, 163, 746, 859, 377, 760, 858, 711, 86, 662, 434, 159, 558, 660, 279, 268, 840, 948, 735, 315, 574, 676, 126, 341, 912, 689, 739, 894, 821, 706, 625, 490, 917, 478, 201, 671, 993, 932, 149, 899, 52, 237, 759, 187, 267, 472, 256, 772, 783, 98, 117, 906, 516, 911, 180, 635, 25, 225, 380, 823, 712, 164, 266, 343, 216, 732, 448, 502, 541, 740, 664, 576, 954, 612, 726, 902, 772, 454, 531, 411, 943, 973, 750, 703, 327, 850, 917, 77, 5, 220, 113, 802, 913, 403, 791, 181, 998, 10, 859, 525, 345, 919, 431, 668, 675, 527, 833, 462, 438, 291, 523, 605, 916, 457, 420, 405, 115, 417, 660, 279, 261, 685, 772, 596, 388, 307, 764, 224, 843, 322, 206, 840, 407, 975, 639, 401, 852, 91, 542, 327, 60, 330, 757, 182, 82, 603, 637, 793, 93, 615, 614, 733, 136, 864, 187, 16, 102, 863, 972, 987, 163, 306, 501, 34, 477
# ])
# capacity = 5034

#2000design variable

profits = np.array([
    585, 194, 426, 606, 348, 516, 521, 1092, 422, 749, 895, 337, 143, 557, 945, 915, 1055, 546, 352, 522, 109, 891, 1001, 459, 222, 767, 194, 698, 838, 107, 674, 644, 815, 434, 982, 866, 467, 1094, 1084, 993, 399, 733, 533, 231, 782, 528, 172, 800, 974, 717, 238, 974, 956, 820, 245, 519, 1095, 894, 629, 296, 299, 1097, 377, 216, 197, 1008, 819, 639, 342, 807, 207, 669, 222, 637, 170, 1031, 198, 826, 700, 587, 745, 872, 367, 613, 1072, 181, 995, 1043, 313, 158, 848, 403, 587, 864, 1023, 636, 129, 824, 774, 889, 640, 579, 654, 242, 567, 439, 146, 741, 810, 296, 653, 594, 291, 166, 824, 924, 830, 308, 1088, 811, 190, 900, 440, 414, 649, 389, 296, 501, 965, 566, 778, 789, 670, 933, 1036, 325, 822, 344, 751, 949, 223, 213, 531, 479, 608, 461, 685, 165, 953, 586, 742, 786, 1092, 386, 825, 989, 386, 124, 912, 591, 959, 991, 763, 190, 188, 281, 279, 314, 287, 117, 719, 572, 361, 518, 946, 519, 292, 456, 361, 782, 614, 406, 986, 301, 630, 485, 949, 1052, 394, 600, 899, 294, 491, 837, 430, 424, 398, 1092, 890, 324, 375, 360, 926, 197, 172, 310, 966, 749, 1051, 1019, 848, 163, 785, 1058, 1056, 904, 664, 618, 283, 528, 500, 637, 821, 446, 307, 253, 423, 1071, 711, 762, 216, 297, 209, 191, 895, 629, 443, 226, 962, 847, 785, 569, 110, 870, 981, 1034, 1084, 823, 503, 995, 460, 668, 549, 272, 641, 1058, 372, 483, 977, 408, 459, 1070, 807, 683, 408, 148, 870, 1030, 130, 669, 308, 103, 411, 120, 200, 709, 1039, 987, 522, 925, 885, 1030, 470, 1004, 1089, 341, 1069, 479, 243, 476, 1072, 1062, 128, 989, 161, 543, 738, 316, 448, 438, 447, 260, 166, 506, 491, 259, 738, 131, 395, 304, 926, 520, 296, 253, 549, 525, 955, 431, 243, 665, 587, 938, 240, 109, 664, 1018, 715, 633, 235, 332, 664, 1057, 460, 691, 893, 676, 263, 846, 959, 477, 860, 958, 811, 186, 762, 534, 259, 658, 760, 379, 368, 940, 1048, 835, 415, 674, 776, 226, 441, 1012, 789, 839, 994, 921, 806, 725, 590, 1017, 578, 301, 771, 1093, 1032, 249, 999, 152, 337, 859, 287, 367, 572, 356, 872, 883, 198, 217, 1006, 616, 1011, 280, 735, 125, 325, 480, 923, 812, 264, 366, 443, 316, 832, 548, 602, 641, 840, 764, 676, 1054, 712, 826, 1002, 872, 554, 631, 511, 1043, 1073, 850, 803, 427, 950, 1017, 177, 105, 320, 213, 902, 1013, 503, 891, 281, 1098, 110, 959, 625, 445, 1019, 531, 768, 775, 627, 933, 562, 538, 391, 623, 705, 1016, 557, 520, 505, 215, 517, 760, 379, 361, 785, 872, 696, 488, 407, 864, 324, 943, 422, 306, 940, 507, 1075, 739, 501, 952, 191, 642, 427, 160, 430, 857, 282, 182, 703, 737, 893, 193, 715, 714, 833, 236, 964, 287, 116, 202, 963, 1072, 1087, 263, 406, 601, 134, 577, 585, 194, 426, 606, 348, 516, 521, 1092, 422, 749, 895, 337, 143, 557, 945, 915, 1055, 546, 352, 522, 109, 891, 1001, 459, 222, 767, 194, 698, 838, 107, 674, 644, 815, 434, 982, 866, 467, 1094, 1084, 993, 399, 733, 533, 231, 782, 528, 172, 800, 974, 717, 238, 974, 956, 820, 245, 519, 1095, 894, 629, 296, 299, 1097, 377, 216, 197, 1008, 819, 639, 342, 807, 207, 669, 222, 637, 170, 1031, 198, 826, 700, 587, 745, 872, 367, 613, 1072, 181, 995, 1043, 313, 158, 848, 403, 587, 864, 1023, 636, 129, 824, 774, 889, 640, 579, 654, 242, 567, 439, 146, 741, 810, 296, 653, 594, 291, 166, 824, 924, 830, 308, 1088, 811, 190, 900, 440, 414, 649, 389, 296, 501, 965, 566, 778, 789, 670, 933, 1036, 325, 822, 344, 751, 949, 223, 213, 531, 479, 608, 461, 685, 165, 953, 586, 742, 786, 1092, 386, 825, 989, 386, 124, 912, 591, 959, 991, 763, 190, 188, 281, 279, 314, 287, 117, 719, 572, 361, 518, 946, 519, 292, 456, 361, 782, 614, 406, 986, 301, 630, 485, 949, 1052, 394, 600, 899, 294, 491, 837, 430, 424, 398, 1092, 890, 324, 375, 360, 926, 197, 172, 310, 966, 749, 1051, 1019, 848, 163, 785, 1058, 1056, 904, 664, 618, 283, 528, 500, 637, 821, 446, 307, 253, 423, 1071, 711, 762, 216, 297, 209, 191, 895, 629, 443, 226, 962, 847, 785, 569, 110, 870, 981, 1034, 1084, 823, 503, 995, 460, 668, 549, 272, 641, 1058, 372, 483, 977, 408, 459, 1070, 807, 683, 408, 148, 870, 1030, 130, 669, 308, 103, 411, 120, 200, 709, 1039, 987, 522, 925, 885, 1030, 470, 1004, 1089, 341, 1069, 479, 243, 476, 1072, 1062, 128, 989, 161, 543, 738, 316, 448, 438, 447, 260, 166, 506, 491, 259, 738, 131, 395, 304, 926, 520, 296, 253, 549, 525, 955, 431, 243, 665, 587, 938, 240, 109, 664, 1018, 715, 633, 235, 332, 664, 1057, 460, 691, 893, 676, 263, 846, 959, 477, 860, 958, 811, 186, 762, 534, 259, 658, 760, 379, 368, 940, 1048, 835, 415, 674, 776, 226, 441, 1012, 789, 839, 994, 921, 806, 725, 590, 1017, 578, 301, 771, 1093, 1032, 249, 999, 152, 337, 859, 287, 367, 572, 356, 872, 883, 198, 217, 1006, 616, 1011, 280, 735, 125, 325, 480, 923, 812, 264, 366, 443, 316, 832, 548, 602, 641, 840, 764, 676, 1054, 712, 826, 1002, 872, 554, 631, 511, 1043, 1073, 850, 803, 427, 950, 1017, 177, 105, 320, 213, 902, 1013, 503, 891, 281, 1098, 110, 959, 625, 445, 1019, 531, 768, 775, 627, 933, 562, 538, 391, 623, 705, 1016, 557, 520, 505, 215, 517, 760, 379, 361, 785, 872, 696, 488, 407, 864, 324, 943, 422, 306, 940, 507, 1075, 739, 501, 952, 191, 642, 427, 160, 430, 857, 282, 182, 703, 737, 893, 193, 715, 714, 833, 236, 964, 287, 116, 202, 963, 1072, 1087, 263, 406, 601, 134, 577, 585, 194, 426, 606, 348, 516, 521, 1092, 422, 749, 895, 337, 143, 557, 945, 915, 1055, 546, 352, 522, 109, 891, 1001, 459, 222, 767, 194, 698, 838, 107, 674, 644, 815, 434, 982, 866, 467, 1094, 1084, 993, 399, 733, 533, 231, 782, 528, 172, 800, 974, 717, 238, 974, 956, 820, 245, 519, 1095, 894, 629, 296, 299, 1097, 377, 216, 197, 1008, 819, 639, 342, 807, 207, 669, 222, 637, 170, 1031, 198, 826, 700, 587, 745, 872, 367, 613, 1072, 181, 995, 1043, 313, 158, 848, 403, 587, 864, 1023, 636, 129, 824, 774, 889, 640, 579, 654, 242, 567, 439, 146, 741, 810, 296, 653, 594, 291, 166, 824, 924, 830, 308, 1088, 811, 190, 900, 440, 414, 649, 389, 296, 501, 965, 566, 778, 789, 670, 933, 1036, 325, 822, 344, 751, 949, 223, 213, 531, 479, 608, 461, 685, 165, 953, 586, 742, 786, 1092, 386, 825, 989, 386, 124, 912, 591, 959, 991, 763, 190, 188, 281, 279, 314, 287, 117, 719, 572, 361, 518, 946, 519, 292, 456, 361, 782, 614, 406, 986, 301, 630, 485, 949, 1052, 394, 600, 899, 294, 491, 837, 430, 424, 398, 1092, 890, 324, 375, 360, 926, 197, 172, 310, 966, 749, 1051, 1019, 848, 163, 785, 1058, 1056, 904, 664, 618, 283, 528, 500, 637, 821, 446, 307, 253, 423, 1071, 711, 762, 216, 297, 209, 191, 895, 629, 443, 226, 962, 847, 785, 569, 110, 870, 981, 1034, 1084, 823, 503, 995, 460, 668, 549, 272, 641, 1058, 372, 483, 977, 408, 459, 1070, 807, 683, 408, 148, 870, 1030, 130, 669, 308, 103, 411, 120, 200, 709, 1039, 987, 522, 925, 885, 1030, 470, 1004, 1089, 341, 1069, 479, 243, 476, 1072, 1062, 128, 989, 161, 543, 738, 316, 448, 438, 447, 260, 166, 506, 491, 259, 738, 131, 395, 304, 926, 520, 296, 253, 549, 525, 955, 431, 243, 665, 587, 938, 240, 109, 664, 1018, 715, 633, 235, 332, 664, 1057, 460, 691, 893, 676, 263, 846, 959, 477, 860, 958, 811, 186, 762, 534, 259, 658, 760, 379, 368, 940, 1048, 835, 415, 674, 776, 226, 441, 1012, 789, 839, 994, 921, 806, 725, 590, 1017, 578, 301, 771, 1093, 1032, 249, 999, 152, 337, 859, 287, 367, 572, 356, 872, 883, 198, 217, 1006, 616, 1011, 280, 735, 125, 325, 480, 923, 812, 264, 366, 443, 316, 832, 548, 602, 641, 840, 764, 676, 1054, 712, 826, 1002, 872, 554, 631, 511, 1043, 1073, 850, 803, 427, 950, 1017, 177, 105, 320, 213, 902, 1013, 503, 891, 281, 1098, 110, 959, 625, 445, 1019, 531, 768, 775, 627, 933, 562, 538, 391, 623, 705, 1016, 557, 520, 505, 215, 517, 760, 379, 361, 785, 872, 696, 488, 407, 864, 324, 943, 422, 306, 940, 507, 1075, 739, 501, 952, 191, 642, 427, 160, 430, 857, 282, 182, 703, 737, 893, 193, 715, 714, 833, 236, 964, 287, 116, 202, 963, 1072, 1087, 263, 406, 601, 134, 577, 585, 194, 426, 606, 348, 516, 521, 1092, 422, 749, 895, 337, 143, 557, 945, 915, 1055, 546, 352, 522, 109, 891, 1001, 459, 222, 767, 194, 698, 838, 107, 674, 644, 815, 434, 982, 866, 467, 1094, 1084, 993, 399, 733, 533, 231, 782, 528, 172, 800, 974, 717, 238, 974, 956, 820, 245, 519, 1095, 894, 629, 296, 299, 1097, 377, 216, 197, 1008, 819, 639, 342, 807, 207, 669, 222, 637, 170, 1031, 198, 826, 700, 587, 745, 872, 367, 613, 1072, 181, 995, 1043, 313, 158, 848, 403, 587, 864, 1023, 636, 129, 824, 774, 889, 640, 579, 654, 242, 567, 439, 146, 741, 810, 296, 653, 594, 291, 166, 824, 924, 830, 308, 1088, 811, 190, 900, 440, 414, 649, 389, 296, 501, 965, 566, 778, 789, 670, 933, 1036, 325, 822, 344, 751, 949, 223, 213, 531, 479, 608, 461, 685, 165, 953, 586, 742, 786, 1092, 386, 825, 989, 386, 124, 912, 591, 959, 991, 763, 190, 188, 281, 279, 314, 287, 117, 719, 572, 361, 518, 946, 519, 292, 456, 361, 782, 614, 406, 986, 301, 630, 485, 949, 1052, 394, 600, 899, 294, 491, 837, 430, 424, 398, 1092, 890, 324, 375, 360, 926, 197, 172, 310, 966, 749, 1051, 1019, 848, 163, 785, 1058, 1056, 904, 664, 618, 283, 528, 500, 637, 821, 446, 307, 253, 423, 1071, 711, 762, 216, 297, 209, 191, 895, 629, 443, 226, 962, 847, 785, 569, 110, 870, 981, 1034, 1084, 823, 503, 995, 460, 668, 549, 272, 641, 1058, 372, 483, 977, 408, 459, 1070, 807, 683, 408, 148, 870, 1030, 130, 669, 308, 103, 411, 120, 200, 709, 1039, 987, 522, 925, 885, 1030, 470, 1004, 1089, 341, 1069, 479, 243, 476, 1072, 1062, 128, 989, 161, 543, 738, 316, 448, 438, 447, 260, 166, 506, 491, 259, 738, 131, 395, 304, 926, 520, 296, 253, 549, 525, 955, 431, 243, 665, 587, 938, 240, 109, 664, 1018, 715, 633, 235, 332, 664, 1057, 460, 691, 893, 676, 263, 846, 959, 477, 860, 958, 811, 186, 762, 534, 259, 658, 760, 379, 368, 940, 1048, 835, 415, 674, 776, 226, 441, 1012, 789, 839, 994, 921, 806, 725, 590, 1017, 578, 301, 771, 1093, 1032, 249, 999, 152, 337, 859, 287, 367, 572, 356, 872, 883, 198, 217, 1006, 616, 1011, 280, 735, 125, 325, 480, 923, 812, 264, 366, 443, 316, 832, 548, 602, 641, 840, 764, 676, 1054, 712, 826, 1002, 872, 554, 631, 511, 1043, 1073, 850, 803, 427, 950, 1017, 177, 105, 320, 213, 902, 1013, 503, 891, 281, 1098, 110, 959, 625, 445, 1019, 531, 768, 775, 627, 933, 562, 538, 391, 623, 705, 1016, 557, 520, 505, 215, 517, 760, 379, 361, 785, 872, 696, 488, 407, 864, 324, 943, 422, 306, 940, 507, 1075, 739, 501, 952, 191, 642, 427, 160, 430, 857, 282, 182, 703, 737, 893, 193, 715, 714, 833, 236, 964, 287, 116, 202, 963, 1072, 1087, 263, 406, 601, 134, 577
])

weights = np.array([
    485, 94, 326, 506, 248, 416, 421, 992, 322, 649, 795, 237, 43, 457, 845, 815, 955, 446, 252, 422, 9, 791, 901, 359, 122, 667, 94, 598, 738, 7, 574, 544, 715, 334, 882, 766, 367, 994, 984, 893, 299, 633, 433, 131, 682, 428, 72, 700, 874, 617, 138, 874, 856, 720, 145, 419, 995, 794, 529, 196, 199, 997, 277, 116, 97, 908, 719, 539, 242, 707, 107, 569, 122, 537, 70, 931, 98, 726, 600, 487, 645, 772, 267, 513, 972, 81, 895, 943, 213, 58, 748, 303, 487, 764, 923, 536, 29, 724, 674, 789, 540, 479, 554, 142, 467, 339, 46, 641, 710, 196, 553, 494, 191, 66, 724, 824, 730, 208, 988, 711, 90, 800, 340, 314, 549, 289, 196, 401, 865, 466, 678, 689, 570, 833, 936, 225, 722, 244, 651, 849, 123, 113, 431, 379, 508, 361, 585, 65, 853, 486, 642, 686, 992, 286, 725, 889, 286, 24, 812, 491, 859, 891, 663, 90, 88, 181, 179, 214, 187, 17, 619, 472, 261, 418, 846, 419, 192, 356, 261, 682, 514, 306, 886, 201, 530, 385, 849, 952, 294, 500, 799, 194, 391, 737, 330, 324, 298, 992, 790, 224, 275, 260, 826, 97, 72, 210, 866, 649, 951, 919, 748, 63, 685, 958, 956, 804, 564, 518, 183, 428, 400, 537, 721, 346, 207, 153, 323, 971, 611, 662, 116, 197, 109, 91, 795, 529, 343, 126, 862, 747, 685, 469, 10, 770, 881, 934, 984, 723, 403, 895, 360, 568, 449, 172, 541, 958, 272, 383, 877, 308, 359, 970, 707, 583, 308, 48, 770, 930, 30, 569, 208, 3, 311, 20, 100, 609, 939, 887, 422, 825, 785, 930, 370, 904, 989, 241, 969, 379, 143, 376, 972, 962, 28, 889, 61, 443, 638, 216, 348, 338, 347, 160, 66, 406, 391, 159, 638, 31, 295, 204, 826, 420, 196, 153, 449, 425, 855, 331, 143, 565, 487, 838, 140, 9, 564, 918, 615, 533, 135, 232, 564, 957, 360, 591, 793, 576, 163, 746, 859, 377, 760, 858, 711, 86, 662, 434, 159, 558, 660, 279, 268, 840, 948, 735, 315, 574, 676, 126, 341, 912, 689, 739, 894, 821, 706, 625, 490, 917, 478, 201, 671, 993, 932, 149, 899, 52, 237, 759, 187, 267, 472, 256, 772, 783, 98, 117, 906, 516, 911, 180, 635, 25, 225, 380, 823, 712, 164, 266, 343, 216, 732, 448, 502, 541, 740, 664, 576, 954, 612, 726, 902, 772, 454, 531, 411, 943, 973, 750, 703, 327, 850, 917, 77, 5, 220, 113, 802, 913, 403, 791, 181, 998, 10, 859, 525, 345, 919, 431, 668, 675, 527, 833, 462, 438, 291, 523, 605, 916, 457, 420, 405, 115, 417, 660, 279, 261, 685, 772, 596, 388, 307, 764, 224, 843, 322, 206, 840, 407, 975, 639, 401, 852, 91, 542, 327, 60, 330, 757, 182, 82, 603, 637, 793, 93, 615, 614, 733, 136, 864, 187, 16, 102, 863, 972, 987, 163, 306, 501, 34, 477, 485, 94, 326, 506, 248, 416, 421, 992, 322, 649, 795, 237, 43, 457, 845, 815, 955, 446, 252, 422, 9, 791, 901, 359, 122, 667, 94, 598, 738, 7, 574, 544, 715, 334, 882, 766, 367, 994, 984, 893, 299, 633, 433, 131, 682, 428, 72, 700, 874, 617, 138, 874, 856, 720, 145, 419, 995, 794, 529, 196, 199, 997, 277, 116, 97, 908, 719, 539, 242, 707, 107, 569, 122, 537, 70, 931, 98, 726, 600, 487, 645, 772, 267, 513, 972, 81, 895, 943, 213, 58, 748, 303, 487, 764, 923, 536, 29, 724, 674, 789, 540, 479, 554, 142, 467, 339, 46, 641, 710, 196, 553, 494, 191, 66, 724, 824, 730, 208, 988, 711, 90, 800, 340, 314, 549, 289, 196, 401, 865, 466, 678, 689, 570, 833, 936, 225, 722, 244, 651, 849, 123, 113, 431, 379, 508, 361, 585, 65, 853, 486, 642, 686, 992, 286, 725, 889, 286, 24, 812, 491, 859, 891, 663, 90, 88, 181, 179, 214, 187, 17, 619, 472, 261, 418, 846, 419, 192, 356, 261, 682, 514, 306, 886, 201, 530, 385, 849, 952, 294, 500, 799, 194, 391, 737, 330, 324, 298, 992, 790, 224, 275, 260, 826, 97, 72, 210, 866, 649, 951, 919, 748, 63, 685, 958, 956, 804, 564, 518, 183, 428, 400, 537, 721, 346, 207, 153, 323, 971, 611, 662, 116, 197, 109, 91, 795, 529, 343, 126, 862, 747, 685, 469, 10, 770, 881, 934, 984, 723, 403, 895, 360, 568, 449, 172, 541, 958, 272, 383, 877, 308, 359, 970, 707, 583, 308, 48, 770, 930, 30, 569, 208, 3, 311, 20, 100, 609, 939, 887, 422, 825, 785, 930, 370, 904, 989, 241, 969, 379, 143, 376, 972, 962, 28, 889, 61, 443, 638, 216, 348, 338, 347, 160, 66, 406, 391, 159, 638, 31, 295, 204, 826, 420, 196, 153, 449, 425, 855, 331, 143, 565, 487, 838, 140, 9, 564, 918, 615, 533, 135, 232, 564, 957, 360, 591, 793, 576, 163, 746, 859, 377, 760, 858, 711, 86, 662, 434, 159, 558, 660, 279, 268, 840, 948, 735, 315, 574, 676, 126, 341, 912, 689, 739, 894, 821, 706, 625, 490, 917, 478, 201, 671, 993, 932, 149, 899, 52, 237, 759, 187, 267, 472, 256, 772, 783, 98, 117, 906, 516, 911, 180, 635, 25, 225, 380, 823, 712, 164, 266, 343, 216, 732, 448, 502, 541, 740, 664, 576, 954, 612, 726, 902, 772, 454, 531, 411, 943, 973, 750, 703, 327, 850, 917, 77, 5, 220, 113, 802, 913, 403, 791, 181, 998, 10, 859, 525, 345, 919, 431, 668, 675, 527, 833, 462, 438, 291, 523, 605, 916, 457, 420, 405, 115, 417, 660, 279, 261, 685, 772, 596, 388, 307, 764, 224, 843, 322, 206, 840, 407, 975, 639, 401, 852, 91, 542, 327, 60, 330, 757, 182, 82, 603, 637, 793, 93, 615, 614, 733, 136, 864, 187, 16, 102, 863, 972, 987, 163, 306, 501, 34, 477, 485, 94, 326, 506, 248, 416, 421, 992, 322, 649, 795, 237, 43, 457, 845, 815, 955, 446, 252, 422, 9, 791, 901, 359, 122, 667, 94, 598, 738, 7, 574, 544, 715, 334, 882, 766, 367, 994, 984, 893, 299, 633, 433, 131, 682, 428, 72, 700, 874, 617, 138, 874, 856, 720, 145, 419, 995, 794, 529, 196, 199, 997, 277, 116, 97, 908, 719, 539, 242, 707, 107, 569, 122, 537, 70, 931, 98, 726, 600, 487, 645, 772, 267, 513, 972, 81, 895, 943, 213, 58, 748, 303, 487, 764, 923, 536, 29, 724, 674, 789, 540, 479, 554, 142, 467, 339, 46, 641, 710, 196, 553, 494, 191, 66, 724, 824, 730, 208, 988, 711, 90, 800, 340, 314, 549, 289, 196, 401, 865, 466, 678, 689, 570, 833, 936, 225, 722, 244, 651, 849, 123, 113, 431, 379, 508, 361, 585, 65, 853, 486, 642, 686, 992, 286, 725, 889, 286, 24, 812, 491, 859, 891, 663, 90, 88, 181, 179, 214, 187, 17, 619, 472, 261, 418, 846, 419, 192, 356, 261, 682, 514, 306, 886, 201, 530, 385, 849, 952, 294, 500, 799, 194, 391, 737, 330, 324, 298, 992, 790, 224, 275, 260, 826, 97, 72, 210, 866, 649, 951, 919, 748, 63, 685, 958, 956, 804, 564, 518, 183, 428, 400, 537, 721, 346, 207, 153, 323, 971, 611, 662, 116, 197, 109, 91, 795, 529, 343, 126, 862, 747, 685, 469, 10, 770, 881, 934, 984, 723, 403, 895, 360, 568, 449, 172, 541, 958, 272, 383, 877, 308, 359, 970, 707, 583, 308, 48, 770, 930, 30, 569, 208, 3, 311, 20, 100, 609, 939, 887, 422, 825, 785, 930, 370, 904, 989, 241, 969, 379, 143, 376, 972, 962, 28, 889, 61, 443, 638, 216, 348, 338, 347, 160, 66, 406, 391, 159, 638, 31, 295, 204, 826, 420, 196, 153, 449, 425, 855, 331, 143, 565, 487, 838, 140, 9, 564, 918, 615, 533, 135, 232, 564, 957, 360, 591, 793, 576, 163, 746, 859, 377, 760, 858, 711, 86, 662, 434, 159, 558, 660, 279, 268, 840, 948, 735, 315, 574, 676, 126, 341, 912, 689, 739, 894, 821, 706, 625, 490, 917, 478, 201, 671, 993, 932, 149, 899, 52, 237, 759, 187, 267, 472, 256, 772, 783, 98, 117, 906, 516, 911, 180, 635, 25, 225, 380, 823, 712, 164, 266, 343, 216, 732, 448, 502, 541, 740, 664, 576, 954, 612, 726, 902, 772, 454, 531, 411, 943, 973, 750, 703, 327, 850, 917, 77, 5, 220, 113, 802, 913, 403, 791, 181, 998, 10, 859, 525, 345, 919, 431, 668, 675, 527, 833, 462, 438, 291, 523, 605, 916, 457, 420, 405, 115, 417, 660, 279, 261, 685, 772, 596, 388, 307, 764, 224, 843, 322, 206, 840, 407, 975, 639, 401, 852, 91, 542, 327, 60, 330, 757, 182, 82, 603, 637, 793, 93, 615, 614, 733, 136, 864, 187, 16, 102, 863, 972, 987, 163, 306, 501, 34, 477, 485, 94, 326, 506, 248, 416, 421, 992, 322, 649, 795, 237, 43, 457, 845, 815, 955, 446, 252, 422, 9, 791, 901, 359, 122, 667, 94, 598, 738, 7, 574, 544, 715, 334, 882, 766, 367, 994, 984, 893, 299, 633, 433, 131, 682, 428, 72, 700, 874, 617, 138, 874, 856, 720, 145, 419, 995, 794, 529, 196, 199, 997, 277, 116, 97, 908, 719, 539, 242, 707, 107, 569, 122, 537, 70, 931, 98, 726, 600, 487, 645, 772, 267, 513, 972, 81, 895, 943, 213, 58, 748, 303, 487, 764, 923, 536, 29, 724, 674, 789, 540, 479, 554, 142, 467, 339, 46, 641, 710, 196, 553, 494, 191, 66, 724, 824, 730, 208, 988, 711, 90, 800, 340, 314, 549, 289, 196, 401, 865, 466, 678, 689, 570, 833, 936, 225, 722, 244, 651, 849, 123, 113, 431, 379, 508, 361, 585, 65, 853, 486, 642, 686, 992, 286, 725, 889, 286, 24, 812, 491, 859, 891, 663, 90, 88, 181, 179, 214, 187, 17, 619, 472, 261, 418, 846, 419, 192, 356, 261, 682, 514, 306, 886, 201, 530, 385, 849, 952, 294, 500, 799, 194, 391, 737, 330, 324, 298, 992, 790, 224, 275, 260, 826, 97, 72, 210, 866, 649, 951, 919, 748, 63, 685, 958, 956, 804, 564, 518, 183, 428, 400, 537, 721, 346, 207, 153, 323, 971, 611, 662, 116, 197, 109, 91, 795, 529, 343, 126, 862, 747, 685, 469, 10, 770, 881, 934, 984, 723, 403, 895, 360, 568, 449, 172, 541, 958, 272, 383, 877, 308, 359, 970, 707, 583, 308, 48, 770, 930, 30, 569, 208, 3, 311, 20, 100, 609, 939, 887, 422, 825, 785, 930, 370, 904, 989, 241, 969, 379, 143, 376, 972, 962, 28, 889, 61, 443, 638, 216, 348, 338, 347, 160, 66, 406, 391, 159, 638, 31, 295, 204, 826, 420, 196, 153, 449, 425, 855, 331, 143, 565, 487, 838, 140, 9, 564, 918, 615, 533, 135, 232, 564, 957, 360, 591, 793, 576, 163, 746, 859, 377, 760, 858, 711, 86, 662, 434, 159, 558, 660, 279, 268, 840, 948, 735, 315, 574, 676, 126, 341, 912, 689, 739, 894, 821, 706, 625, 490, 917, 478, 201, 671, 993, 932, 149, 899, 52, 237, 759, 187, 267, 472, 256, 772, 783, 98, 117, 906, 516, 911, 180, 635, 25, 225, 380, 823, 712, 164, 266, 343, 216, 732, 448, 502, 541, 740, 664, 576, 954, 612, 726, 902, 772, 454, 531, 411, 943, 973, 750, 703, 327, 850, 917, 77, 5, 220, 113, 802, 913, 403, 791, 181, 998, 10, 859, 525, 345, 919, 431, 668, 675, 527, 833, 462, 438, 291, 523, 605, 916, 457, 420, 405, 115, 417, 660, 279, 261, 685, 772, 596, 388, 307, 764, 224, 843, 322, 206, 840, 407, 975, 639, 401, 852, 91, 542, 327, 60, 330, 757, 182, 82, 603, 637, 793, 93, 615, 614, 733, 136, 864, 187, 16, 102, 863, 972, 987, 163, 306, 501, 34, 477
])

capacity = 10068

# profits = np.array([
#     94, 506, 416, 992, 649, 237, 457, 815, 446, 422, 791, 359, 667, 598, 7, 544, 334, 766, 994, 893, 633, 131, 428, 700, 617, 874, 720, 419, 794, 196, 997, 116, 908, 539, 707, 569, 537, 931, 726, 487, 772, 513, 81, 943, 58, 303, 764, 536, 724, 789, 479, 142, 339, 641, 196, 494, 66, 824, 208, 711, 800, 314, 289, 401, 466, 689, 833, 225, 244, 849, 113, 379, 361, 65, 486, 686, 286, 889, 24, 491, 891, 90, 181, 214, 17, 472, 418, 419, 356, 682, 306, 201, 385, 952, 500, 194, 737, 324, 992, 224, 260, 97, 210, 649, 919, 63, 958, 804, 518, 428, 537, 346, 153, 971, 662, 197, 91, 529, 126, 747, 469, 770, 934, 723, 895, 568, 172, 958, 383, 308, 970, 583, 48, 930, 569, 3, 20, 609, 887, 825, 930, 904, 241, 379, 376, 962, 889, 443, 216, 338, 160, 406, 159, 31, 204, 420, 153, 425, 331, 565, 838, 9, 918, 533, 232, 957, 591, 576, 746, 377, 858, 86, 434, 558, 279, 840, 735, 574, 126, 912, 739, 821, 625, 917, 201, 993, 149, 52, 759, 267, 256, 783, 117, 516, 180, 25, 380, 712, 266, 216, 448, 541, 664, 954, 726, 772, 531, 943, 750, 327, 917, 5, 113, 913, 791, 998, 859, 345, 431, 675, 833, 438, 523, 916, 420, 115, 660, 261, 772, 388, 764, 843, 206, 407, 639, 852, 542, 60, 757, 82, 637, 93, 614, 136, 187, 102, 972, 163, 501, 477, 492, 121, 80, 138, 660, 229, 827, 448, 230, 832, 489, 586, 291, 665, 660, 702, 153, 606, 123, 253, 709, 832, 108, 888, 481, 283, 858, 284, 711, 850, 239, 943, 195, 95, 410, 664, 900, 112, 963, 754, 458, 19, 225, 569, 97, 194, 754, 602, 61, 695, 347, 719, 100, 97, 843, 745, 286, 492, 116, 531, 424, 253, 426, 413, 980, 291, 833, 486, 9, 575, 922, 145, 897, 404, 742, 728, 269, 103, 745, 35, 779, 71, 80, 842, 128, 941, 227, 30, 342, 605, 531, 364, 359, 867, 820, 313, 207, 911, 308, 430, 685, 641, 113, 141, 690, 700, 559, 481, 503, 766, 7, 882, 859, 182, 425, 542, 683, 853, 938, 89, 624, 181, 878, 933, 580, 252, 207, 658, 20, 954, 347, 759, 446, 14, 657, 710, 980, 188, 636, 203, 432, 129, 630, 509, 237, 373, 838, 395, 692, 103, 218, 384, 931, 396, 389, 640, 287, 297, 977, 512, 219, 555, 398, 289, 798, 598, 49, 572, 697, 770, 725, 542, 214, 887, 45, 94, 282, 82, 319, 626, 146, 541, 874, 725, 777, 554, 208, 787, 976, 912, 444, 3, 301, 164, 437, 652, 764, 41, 737, 176, 136, 128, 394, 235, 42, 824, 684, 979, 568, 367, 52, 642, 335, 126, 130, 583, 129, 752, 167, 856, 640, 770, 431, 195, 448, 701, 952, 880, 168, 79, 961, 472, 217, 709, 147, 296, 909, 764, 251, 878, 753, 570, 253, 666, 931, 433, 810, 678, 123, 212
# ])
#
# weights = np.array([
#     485, 326, 248, 421, 322, 795, 43, 845, 955, 252, 9, 901, 122, 94, 738, 574, 715, 882, 367, 984, 299, 433, 682, 72, 874, 138, 856, 145, 995, 529, 199, 277, 97, 719, 242, 107, 122, 70, 98, 600, 645, 267, 972, 895, 213, 748, 487, 923, 29, 674, 540, 554, 467, 46, 710, 553, 191, 724, 730, 988, 90, 340, 549, 196, 865, 678, 570, 936, 722, 651, 123, 431, 508, 585, 853, 642, 992, 725, 286, 812, 859, 663, 88, 179, 187, 619, 261, 846, 192, 261, 514, 886, 530, 849, 294, 799, 391, 330, 298, 790, 275, 826, 72, 866, 951, 748, 685, 956, 564, 183, 400, 721, 207, 323, 611, 116, 109, 795, 343, 862, 685, 10, 881, 984, 403, 360, 449, 541, 272, 877, 359, 707, 308, 770, 30, 208, 311, 100, 939, 422, 785, 370, 989, 969, 143, 972, 28, 61, 638, 348, 347, 66, 391, 638, 295, 826, 196, 449, 855, 143, 487, 140, 564, 615, 135, 564, 360, 793, 163, 859, 760, 711, 662, 159, 660, 268, 948, 315, 676, 341, 689, 894, 706, 490, 478, 671, 932, 899, 237, 187, 472, 772, 98, 906, 911, 635, 225, 823, 164, 343, 732, 502, 740, 576, 612, 902, 454, 411, 973, 703, 850, 77, 220, 802, 403, 181, 10, 525, 919, 668, 527, 462, 291, 605, 457, 405, 417, 279, 685, 596, 307, 224, 322, 840, 975, 401, 91, 327, 330, 182, 603, 793, 615, 733, 864, 16, 863, 987, 306, 34, 840, 700, 706, 787, 105, 834, 798, 310, 609, 690, 561, 579, 60, 388, 309, 407, 200, 313, 970, 33, 273, 277, 997, 40, 227, 860, 940, 608, 990, 590, 806, 52, 801, 764, 710, 386, 593, 50, 494, 156, 936, 965, 86, 723, 184, 868, 340, 412, 487, 209, 346, 860, 307, 95, 821, 941, 821, 587, 201, 665, 527, 812, 424, 459, 343, 836, 506, 179, 916, 430, 596, 808, 269, 512, 811, 685, 567, 776, 855, 718, 853, 97, 146, 746, 15, 965, 512, 480, 958, 665, 191, 964, 515, 606, 822, 536, 693, 19, 335, 101, 922, 294, 910, 410, 250, 546, 729, 609, 720, 976, 759, 798, 74, 648, 299, 785, 846, 390, 897, 416, 837, 247, 293, 144, 938, 467, 480, 955, 665, 26, 564, 449, 26, 521, 301, 321, 613, 388, 879, 990, 188, 963, 820, 300, 822, 255, 277, 153, 400, 227, 518, 447, 315, 813, 324, 502, 299, 780, 376, 516, 212, 329, 810, 486, 485, 416, 952, 894, 358, 21, 647, 44, 683, 361, 814, 231, 8, 165, 496, 699, 852, 459, 535, 314, 944, 306, 459, 637, 447, 408, 107, 962, 565, 407, 857, 317, 98, 818, 600, 288, 902, 567, 190, 749, 908, 276, 748, 592, 393, 363, 163, 983, 179, 16, 478, 259, 868, 295, 596, 71, 622, 864, 644, 5, 365, 429, 64, 854, 770, 88, 157, 368, 421, 719, 271, 975, 816, 962, 535, 438, 696, 881, 318, 45, 52, 496, 313, 138, 334, 988
# ])
# capacity = 2543



# profits = np.array([482, 257, 286, 517, 404, 713, 45, 924, 873, 160, 1, 838, 40, 58, 676, 627, 766, 862, 405, 923,
#            379, 461, 612, 133, 813, 97, 908, 165, 996, 623, 220, 298, 157, 723, 144, 48, 129, 148, 35, 644,
#            632, 272, 1040, 977, 312, 778, 567, 965, 1, 616, 569, 628, 493, 76, 733, 575, 288, 775, 723, 912,
#            64, 354, 565, 210, 922, 775, 566, 934, 626, 742, 194, 485, 483, 617, 876, 653, 896, 652, 220, 727,
#            900, 563, 56, 157, 280, 537, 284, 920, 124, 239, 459, 931, 504, 910, 382, 795, 485, 351, 289, 865])
#
# weights = np.array([485, 326, 248, 421, 322, 795, 43, 845, 955, 252, 9, 901, 122, 94, 738, 574, 715, 882, 367, 984,
#            299, 433, 682, 72, 874, 138, 856, 145, 995, 529, 199, 277, 97, 719, 242, 107, 122, 70, 98, 600,
#            645, 267, 972, 895, 213, 748, 487, 923, 29, 674, 540, 554, 467, 46, 710, 553, 191, 724, 730, 988,
#            90, 340, 549, 196, 865, 678, 570, 936, 722, 651, 123, 431, 508, 585, 853, 642, 992, 725, 286, 812,
#            859, 663, 88, 179, 187, 619, 261, 846, 192, 261, 514, 886, 530, 849, 294, 799, 391, 330, 298, 790])
#
# capacity = 995

# profits = np.array([1945, 321, 2945, 4136, 1107, 1022, 1101, 2890, 962, 1060, 805, 689, 1513, 3878, 13504, 1865, 667, 1833, 16553])
# weights = np.array([4990, 1142, 7390, 10372, 3114, 2744, 3102, 7280, 2624, 3020, 2310, 2078, 3926, 9656, 32708, 4830, 2034, 4766, 40006])
# capacity = 31181

# GA parameters
N = 500
generations = 1000
trials = 30
z = 6
p = len(profits)
num_vectors = 2 ** z
e = 1  #the number of extra ones
crossover_rate = 0.9
mutation_rate = 0.2


# Base vectors
# base_vectors = [([int(b) for b in format(i, f'0{p}b')]) for i in range(num_vectors)]




# Deb's fitness function
def evaluate_vector(vec):
    total_weight = np.dot(vec, weights)
    total_profit = np.dot(vec, profits)
    violation = max(0, total_weight - capacity)
    return total_profit, violation
def deb_fitness(vec, min_feas_fit):
    profit, violation = evaluate_vector(vec)
    if violation == 0:
        return profit, True, 0
    else:
        return min_feas_fit - violation, False, violation

def generate_RT():
    R = np.zeros((p, p), dtype=int)
    for i in range(p):
        R[i][i] = 1
        extra_ones = random.sample([j for j in range(p) if j != i], min(e, p - 1))
        for j in extra_ones:
            R[i][j] = 1
    T = np.zeros(p, dtype=int)
    ones_count = random.randint(1, p)
    T[random.sample(range(p), ones_count)] = 1
    return R, T


best_fitness_across_trials = []
best_vectors_across_trials = []

for trial in range(trials):
    population = [generate_RT() for _ in range(N)]
    best_feas_fitness_ever = -1
    best_feas_vec_ever = None
    min_feasible = float("inf")
    hadamard_positions = random.sample(range(p), z)  # Choose 'z' random positions for Hadamard gates
    superposed_bits = list(product([0, 1], repeat=z))  # Generate all 2^z combinations
    # base_vectors = [[random.randint(0, 1) for _ in range(p)] for _ in range(num_vectors)]
    # initial_vectors = np.array(base_vectors)
    base_vectors = []
    for bits in superposed_bits:
        vec = [0] * p
        for idx, pos in enumerate(hadamard_positions):
            vec[pos] = bits[idx]
        base_vectors.append(vec)

    initial_vectors = np.array(base_vectors)
    output_dir = r"C:\Users\SupreethBhaskar\PycharmProjects\circuit_search\unifrom crossover results\results_2000_1_c500_g1000_rp0.5_z=6\results_2000_1_c500_g1000_rp0.5_z=6"
    os.makedirs(output_dir, exist_ok=True)
    csv_filename = os.path.join(output_dir, f"trial_{trial + 1}.csv")
    with open(csv_filename, 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)


        generation = 0
        while generation < generations:
            # Sample one vector
            sampled_vec = initial_vectors[random.randint(0, num_vectors - 1)] #a vector is sample from the initial vectors

            # Step 1: Evaluate all transformed vectors to find global min_feasible and best feasible vector
            min_feasible = float('inf')  # Reset min feasible at each generation if desired
            fitness_results = []
            all_transformed = []  # store (transformed_vector, R, T) for Deb fitness calculation

            for R, T in population:
                transformed = (sampled_vec @ R) % 2 #binary vector
                transformed = (transformed + T) % 2

                profit, violation = evaluate_vector(transformed)
                if violation == 0 and profit < min_feasible:
                    min_feasible = profit
                if violation == 0 and profit > best_feas_fitness_ever:
                    best_feas_fitness_ever = profit
                    best_feas_vec_ever = transformed.copy()

                all_transformed.append((transformed, R, T))
            #at the end of this process,all r,t pairs have transformed the sampled vector.
            # The resulting vector and the associated r,t pair is a tuple stored in the list all_transformed

            # Step 2: Calculate Deb fitness using global min_feasible
            fitness_results = [] #a list of tuples, where each tuple is deb fiitness and the r and t pair.
            for vec, R, T in all_transformed:
                deb_fit, _, _ = deb_fitness(vec, min_feasible)
                fitness_results.append((deb_fit, R, T))
            #here, deb fitness has been assigned to each r,t pair
            # Binary Tournament Selection
            selected = []
            for _ in range(N):
                a, b = random.sample(fitness_results, 2)
                selected.append(a if a[0] > b[0] else b)

            # Crossover and Mutation
            # next_gen = []
            # for i in range(0, N, 2):
            #     fit1, R1, T1 = selected[i]
            #     fit2, R2, T2 = selected[i + 1]
            #
            #     R1, R2 = R1.copy(), R2.copy()
            #     T1, T2 = T1.copy(), T2.copy()
            #
            #     if random.random() < crossover_rate:
            #         row = random.randint(0, p - 1)
            #         R1[row], R2[row] = R2[row].copy(), R1[row].copy()
            #
            #         point = random.randint(1, p - 1)
            #         T1_new = np.concatenate([T1[:point], T2[point:]])
            #         T2_new = np.concatenate([T2[:point], T1[point:]])
            #         T1, T2 = T1_new, T2_new
            #
            #     next_gen.append((R1, T1))
            #     next_gen.append((R2, T2))

            #uniform crossover
            next_gen = []
            for i in range(0, N, 2):
                fit1, R1, T1 = selected[i]
                fit2, R2, T2 = selected[i + 1]

                R1, R2 = R1.copy(), R2.copy()
                T1, T2 = T1.copy(), T2.copy()

                if random.random() < crossover_rate:
                    # --- Uniform crossover for R ---
                    for row in range(p):
                        if random.random() < 0.5:
                            R1[row], R2[row] = R2[row].copy(), R1[row].copy()

                    # --- Uniform crossover for T ---
                    mask = np.random.randint(0, 2, size=p)
                    T1_new = (T1 & ~mask) | (T2 & mask)
                    T2_new = (T2 & ~mask) | (T1 & mask)
                    T1, T2 = T1_new, T2_new

                    # --- one-point crossover for T ---
                    # point = random.randint(1, p - 1)
                    # T1_new = np.concatenate([T1[:point], T2[point:]])
                    # T2_new = np.concatenate([T2[:point], T1[point:]])
                    # T1, T2 = T1_new, T2_new

                next_gen.append((R1, T1))
                next_gen.append((R2, T2))

            #single-point row crossover
            # next_gen = []
            # for i in range(0, N, 2):
            #     fit1, R1, T1 = selected[i]
            #     fit2, R2, T2 = selected[i + 1]
            #
            #     R1, R2 = R1.copy(), R2.copy()
            #     T1, T2 = T1.copy(), T2.copy()
            #
            #     if random.random() < crossover_rate:
            #         # --- Single-point row crossover for R ---
            #         point_row = random.randint(1, p - 1)  # choose 1 â‰¤ point < p
            #         R1_rows_to_swap = R1[point_row:].copy()
            #         R2_rows_to_swap = R2[point_row:].copy()
            #         R1[point_row:] = R2_rows_to_swap
            #         R2[point_row:] = R1_rows_to_swap
            #
            #         # --- Single-point crossover for T ---
            #         point_t = random.randint(1, p - 1)
            #         T1_new = np.concatenate([T1[:point_t], T2[point_t:]])
            #         T2_new = np.concatenate([T2[:point_t], T1[point_t:]])
            #         T1, T2 = T1_new, T2_new
            #
            #     next_gen.append((R1, T1))
            #     next_gen.append((R2, T2))

            # Mutation
            for idx in range(N):
                if random.random() < mutation_rate:
                    R, T = next_gen[idx]
                    row = random.randint(0, p - 1)
                    non_diag = [i for i in range(p) if i != row]
                    R[row] = np.eye(1, p, row, dtype=int).flatten()
                    R[row][random.choice(non_diag)] = 1

                    flip_mask = np.random.rand(p) < (1 / p)
                    T = (T ^ flip_mask.astype(int)) % 2
                    next_gen[idx] = (R, T)

            #mutation2
            # for idx in range(N):
            #     if random.random() < mutation_rate:
            #         R, T = next_gen[idx]
            #
            #         ### Mutation for R
            #         mutation_strength = random.choice(["mild", "medium", "strong"])
            #
            #         if mutation_strength == "mild":
            #             # Flip 1 off-diagonal bit in 1 random row
            #             row = random.randint(0, p - 1)
            #             non_diag_cols = [i for i in range(p) if i != row]
            #             col = random.choice(non_diag_cols)
            #             R[row, col] ^= 1
            #
            #         elif mutation_strength == "medium":
            #             # Flip 1 off-diagonal bit in each of 2-3 random rows
            #             num_rows = random.randint(2, 3)
            #             rows = random.sample(range(p), num_rows)
            #             for row in rows:
            #                 non_diag_cols = [i for i in range(p) if i != row]
            #                 col = random.choice(non_diag_cols)
            #                 R[row, col] ^= 1
            #
            #         else:  # "strong"
            #             row = random.randint(0, p - 1)
            #             R[row] = np.zeros(p, dtype=int)
            #             R[row, row] = 1
            #             extra_ones = random.sample([i for i in range(p) if i != row],
            #                                        k=random.randint(1, min(3, p - 1)))
            #             for pos in extra_ones:
            #                 R[row, pos] = 1
            #
            #         ### Mutation for T
            #         flip_prob = random.choice([0.05, 0.1, 0.2])
            #         flip_mask = np.random.rand(p) < flip_prob
            #         T = (T ^ flip_mask.astype(int)) % 2
            #
            #         next_gen[idx] = (R, T)

            # Step 3: Evaluate new generation on the same sampled vector to update min_feasible & best feasible
            all_transformed_new = []
            for R, T in next_gen:
                transformed = (sampled_vec @ R) % 2
                transformed = (transformed + T) % 2

                profit, violation = evaluate_vector(transformed)
                if violation == 0 and profit < min_feasible:
                    min_feasible = profit
                if violation == 0 and profit > best_feas_fitness_ever:
                    best_feas_fitness_ever = profit
                    best_feas_vec_ever = transformed.copy()

                all_transformed_new.append((transformed, R, T))

            # Step 4: Calculate Deb fitness for new generation using updated min_feasible
            new_results = []
            for vec, R, T in all_transformed_new:
                deb_fit, _, _ = deb_fitness(vec, min_feasible)
                new_results.append((deb_fit, R, T))

            # Elitism: keep top N from old + new
            combined = fitness_results + new_results
            combined.sort(reverse=True, key=lambda x: x[0])
            population = [(R, T) for _, R, T in combined[:N]]
            if best_feas_vec_ever is not None:
                writer.writerow([best_feas_fitness_ever, best_feas_vec_ever.tolist()])
            else:
                writer.writerow([0, []])
            generation += 1

    best_fitness_across_trials.append(best_feas_fitness_ever if best_feas_vec_ever is not None else 0)
    best_vectors_across_trials.append(best_feas_vec_ever)
    print(f"Trial {trial + 1}/{trials}: Best Feasible Fitness = {best_fitness_across_trials[-1]}")
    print(f"Vector: {best_feas_vec_ever}")

# Assuming best_fitness_across_trials is a list or array of numbers
best = np.array(best_fitness_across_trials)

mean_fitness = np.mean(best)
median_fitness = np.median(best)
max_fitness = np.max(best)
min_fitness = np.min(best)

print(f"Mean Feasible Fitness: {mean_fitness:.2f}")
print(f"Median Feasible Fitness: {median_fitness:.2f}")
print(f"Maximum Feasible Fitness: {max_fitness}")
print(f"Minimum Feasible Fitness: {min_fitness}")

# Plotting boxplot
plt.figure(figsize=(10, 6))
plt.boxplot(best_fitness_across_trials, vert=True, patch_artist=True,
            boxprops=dict(facecolor='lightblue'))
plt.title('Best Feasible Fitness Across 30 Trials')
plt.ylabel('Feasible Fitness')
plt.ylim(99700, 100000)  # Set y-axis limits
plt.grid(True)
plt.show()
